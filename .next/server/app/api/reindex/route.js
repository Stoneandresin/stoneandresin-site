"use strict";(()=>{var e={};e.id=847,e.ids=[847],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6623:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>x,patchFetch:()=>f,requestAsyncStorage:()=>d,routeModule:()=>u,serverHooks:()=>l,staticGenerationAsyncStorage:()=>c});var o={};t.r(o),t.d(o,{POST:()=>p});var s=t(9303),n=t(8716),i=t(3131),a=t(7070);async function p(e){try{let e=process.env.CLOUDINARY_CLOUD_NAME,r=process.env.CLOUDINARY_API_KEY||process.env.NEXT_PUBLIC_CLOUDINARY_API_KEY,t=process.env.CLOUDINARY_API_SECRET;if(!e||!r||!t)return a.NextResponse.json({ok:!1,error:"Missing Cloudinary env vars"},{status:500});let o=await fetch(`https://api.cloudinary.com/v1_1/${e}/resources/search`,{method:"POST",headers:{Authorization:"Basic "+Buffer.from(`${r}:${t}`).toString("base64"),"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({expression:'folder="before-after" AND resource_type:image',max_results:"500"}).toString(),cache:"no-store"});if(!o.ok){let e=await o.text();return a.NextResponse.json({ok:!1,error:"cloudinary_error",detail:e},{status:500})}let s=await o.json(),n=new Map;for(let e of s.resources){let r=e.public_id.split("/").pop().split("-"),t=r.findIndex(e=>"before"===e||"after"===e);if(t<=0)continue;let o=r.slice(0,t).join("-"),s=r[t],i=n.get(o)||{before:[],after:[]};i[s].push(e.secure_url),n.set(o,i)}return a.NextResponse.json({ok:!0,pairs:[...n.entries()].map(([e,r])=>({jobId:e,...r}))})}catch(e){return console.error("Reindex error:",e),a.NextResponse.json({ok:!1,error:"unexpected"},{status:500})}}let u=new s.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/reindex/route",pathname:"/api/reindex",filename:"route",bundlePath:"app/api/reindex/route"},resolvedPagePath:"/home/runner/work/stoneandresin-site/stoneandresin-site/app/api/reindex/route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:d,staticGenerationAsyncStorage:c,serverHooks:l}=u,x="/api/reindex/route";function f(){return(0,i.patchFetch)({serverHooks:l,staticGenerationAsyncStorage:c})}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[948,972],()=>t(6623));module.exports=o})();